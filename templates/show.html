<!-- .. -->
{% extends "base.html" %} 
{% block title %} List of Contacts {% endblock %} 
{% block content %}
<div
id="fire_reload"
hx-get="/contacts/count"
hx-trigger="fire_reload from:body, load delay:300ms"
hx-target="#contacts_count"
>
</div>



<div class="mx-auto border-2 border-neutral rounded-md px-6 p-3 mt-3 bg-neutral">   
  <ul class="w-full" id="flash">
    {% for message in messages_t %}
    <li>
      {% if message.level == Level::Error %}
      <button class="text-center bg-error text-error-content rounded-full text-lg font-bold w-full"
      hx-get="/utils/close-flash"
      hx-target="#flash">
        {{ message }}
        <i class="fa-regular fa-circle-xmark"></i>
      </button>
      {% else %}
      <button class="text-center bg-success text-success-content rounded-full text-lg font-bold w-full"
      hx-get="/utils/close-flash"
      hx-target="#flash">
        {{ message }}
        <i class="fa-regular fa-circle-xmark"></i>
      </button>
      {% endif %}
    </li>
    {% endfor %}
  </ul>


  <div class="flex justify-around py-2">
    <div class="flex font-semibold text-accent py-3">
      <i class="fa-regular fa-calendar-days fa-lg text-accent px-2 pt-3"></i>
      {{ time_t }}
    </div>
    {% if birthday_t == 0 %}
    <div class="flex font-semibold text-accent text-xl">
      <i class="fa-solid fa-address-book fa-lg text-accent px-2 pt-3"></i>
      All Contacts
    </div>
    {% else %}
    <div class="flex font-semibold text-accent text-xl">
      <i class="fa-solid fa-list fa-lg text-accent px-2 pt-3"></i>
      Upcoming Bdays
    </div>
    {% endif %}
    <div class="flex font-semibold text-accent py-3">
      <i class="fa-solid fa-users fa-lg text-accent px-2 pt-3"></i>
      <div class="w-20"
      id="contacts_count"
      > 
        <span class="loading loading-bars loading-md text-accent"></span>
        <!--<img src="/assets/spinner.svg" class="h-6 w-6 animate-spin" />-->
      </div>
    </div>
  </div>

  <div class="flex justify-evenly py-1">
    <label class="input input-bordered input-primary flex items-center gap-2 pr-0">
      <i class="fa-solid fa-magnifying-glass fa-lg text-primary"></i>   
      <input class="grow"   
      id="search"
      type="search"
      name="search_p"
      placeholder="Search"
      value="{{ search_t }}"
      hx-get="/contacts/show?page_p=1&birthday_p=0"
      hx-include="#search"
      hx-trigger="change, keyup delay:300ms changed"
      hx-target="#tbody"
      hx-push-url="true"
      hx-indicator="#spinner"
      />
      <span class="htmx-indicator loading loading-bars loading-sm text-primary"
      id="spinner">
      </span>
      <select class="select select-bordered join-item select-primary">
        <option selected>All</option>
        <option>Nexy Bdays</option>
        <option>Prev Bdays</option>
      </select>
    </label>
    <div class="flex">
      <a class="btn btn-secondary text-lg"
      href="/contacts/new?id=0&first_name=&last_name=&phone=&email=&birth_date=&time_creation="
      >
        <i class="fa-solid fa-user-plus fa-lg"></i>
      </a>
    </div>
  </div>
  

  <div class="overflow-x-auto">
     <form enctype="application/x-www-form-urlencoded">
      <table class="table-lg">
        <thead>
          <tr>
            <th>
              <button
                class="btn btn-secondary btn-xs"
                hx-delete="/contacts/show?page_p=1&birthday_p=0"
                hx-confirm="Are you sure you want to delete these contacts?"
                hx-target="body"
              >
                <i class="fa-regular fa-trash-can"></i>       
              </button>
            </th>
            <!--<th >
              ID
            </th>-->
            <th >
              First Name
            </th>
            <th >
              Last Name
            </th>
            <th >
              Birth Date
            </th>
            <!--  <th class="table-cell rounded-md bg-indigo-300 px-2 py-1 text-left">Phone</th>
            <th class="table-cell rounded-md bg-indigo-300 px-2 py-1 text-left">Email</th> 
            <th class="table-cell rounded-md bg-indigo-300 px-2 py-1 text-left">
              Creation Time
            </th> -->
            <th>
              Actions
            </th>
          </tr>
        </thead>
        <tbody id="tbody">
          {% include "show_rows.html" %}
        </tbody>
      </table>
    </form>
  </div>
</div>
<div class="h-3">
</div>
{% endblock %}
